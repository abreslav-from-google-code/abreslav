\section{Modified Parallel Filtering Model}\label{mpfm}
\begin{itemize}
	\item Introduce Parallel Copy
	\item Introduce Parallel Union
	\item Introduce Principles of parallel Remove
	\item Describe implementation of Parallel Remove
\end{itemize}

However, nature of such operations does not require sequential execution. Some steps can be performed in parallel which leads to lower time complexities.
Let us start with $Union$. If we need to union $n$ tubes $T_1...T_n$ together we can first union $n/2$ pairs $(T_i, T_{i+1})$ in parallel, which results in $n/2$ tubes to be united. Applying the same operation recursively we can achieve the goal in $O(log(n))$ steps instead of $O(n)$.

\subsection{Parallel $Copy$ operation}
\PROCEDURE $Copy(T, \{T_1, ..., T_n\})$
\begin{algorithmic}[1]
  \IF{$n = 1$}
	  \STATE $T_1 \gets T$ \label{c_one}
  \ELSIF{$n = 2$}
	  \STATE $Copy(T, T_1, T_2)$ \label{c_two}
  \ELSIF{$n \geq 2$}
	  \STATE $Copy(T, T'_1, T'_2)$
    \INPARALLELDO
      \PSTATE $Copy(T'_1, \{T_1, \dots, T_{\lceil n/2 \rceil}\})$	\label{c_left}
      \PSTATE $Copy(T'_2, \{T_{\lceil n/2 \rceil+1}, \dots, T_n\})$	\label{c_right}
    \ENDINPARALLELDO
	\ENDIF
\end{algorithmic}

\lemma{copy_l}{
Provided implementation of $Copy$ ends up with result of producing $n$ copies of multiset $T$ and takes $O(log(n)))$ parallel time.
}{
Lines \ref{c_one} and \ref{c_two} properly handle basic cases of $Copy$ and form the recursion base.

Calls made on lines \ref{c_left} and \ref{c_right} reduce problem size to $n/2$. Assuming that $Copy$ works properly for $\vec{T}$ of size $n/2$ we see that these two calls fill up vector of size $n$ with copies of original multiset.

Each level of recursion reduces $n$ to $n/2$, thus any call to $Copy$ ends up in one of basic cases after $O(log(n))$ recursive calls. As any recursive call makes constant number of steps and lines \ref{c_left} and \ref{c_right} are executed in parallel the whole operation ends up in $O(lon(n))$ parallel time.
}

\subsection{Parallel $Union$ operation}
\PROCEDURE $Union(\{T_1, ..., T_n\}, T)$
\begin{algorithmic}[1]
	\STATE $m \gets \lfloor n/2 \rfloor$
  \FOR{$i \gets 1$ \TO $m$ \INPARALLEL}
  	\STATE $Union(T_{2i-1}, T_{2i}, T'_i)$
  \ENDFOR
  \IF{$2m < n$}
    \STATE $Union(T_n, T'_{m+1}) $
    \STATE $m \gets m+1$
  \ENDIF
  \STATE $Union(\{T'_1, \dots, T'_m\}, T)$
\end{algorithmic}

\lemma{union_l}{
Provided implementation of $Union$ ends up with result of union of multisets $T_1, \dots, T_n$ into $T$ and takes $O(log(n)))$ parallel time.
}{
}
\subsection{Parallel $Remove$ operation}
{\bf procedure} $Remove(T, \{s_1, \dots, s_n\})$
\begin{algorithmic}[1]
	\STATE $Copy(T, \{T_1, \dots, T_n\})$
  \FOR{$i \gets 1$ \TO $n$ \INPARALLEL}
  	\STATE $Remove(T_i, s_i)$
  \ENDFOR
  \STATE $Intersect(\{T_1, \dots, T_n\}, T)$
\end{algorithmic}

\subsection{$Intersect$ operation and it's parallel version}

Refer to \cite{Dantsin:2003}

\PROCEDURE $Intersect(\{T_1, ..., T_n\}, T)$
\begin{algorithmic}[1]
	\STATE $m \gets \lfloor n/2 \rfloor$
  \FOR{$i \gets 1$ \TO $m$ \INPARALLEL}
  	\STATE $Intersect(T_{2i-1}, T_{2i}, T'_i)$
  \ENDFOR
  \IF{$2m < n$}
    \STATE $T'_{m+1} \gets T_n$
    \STATE $m \gets m+1$
  \ENDIF
  \STATE $Intersect(\{T'_1, \dots, T'_m\}, T)$
\end{algorithmic}

